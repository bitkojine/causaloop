
> test
> vitest run --reporter=verbose

 DEPRECATED  The workspace file is deprecated and will be removed in the next major. Please, use the `test.projects` field in the root config file instead.

 RUN  v3.2.4 /Users/name/trusted-git/public-repos/battle-tester/causaloop-repo

 ✓ |core| src/dispatcher.test.ts > Dispatcher > should process messages and update model 2ms
 ✓ |core| src/dispatcher.test.ts > Dispatcher > should handle nested dispatches via FIFO queue (no re-entrancy) 1ms
 ✓ |core| src/dispatcher.test.ts > Dispatcher > should deep-freeze model in dev mode 1ms
 ✓ |core| src/dispatcher.test.ts > Dispatcher > should throttle notifications (batch updates) 2ms
 ✓ |core| src/stress/replay_reliability.test.ts > Replay Reliability Torture > Replays a long log (100k entries) for final state consistency 28ms
 ✓ |core| src/stress/replay_reliability.test.ts > Replay Reliability Torture > Hunt Nondeterminism: verifying replay matches live session with mocks 1ms
 ✓ |core| src/stress/mvu.test.ts > Stress: MVU Correctness & Race Resistance > handles high throughput spam (100k messages) 46ms
 ✓ |core| src/stress/mvu.test.ts > Stress: MVU Correctness & Race Resistance > handles mixed message bursts 9ms
 ✓ |core| src/stress/mvu.test.ts > Stress: MVU Correctness & Race Resistance > enforces FIFO ordering with synchronous re-entrancy (Effect-triggered dispatch) 1ms
 ✓ |core| src/stress/mvu.test.ts > Stress: MVU Correctness & Race Resistance > handles recursive re-entrancy limit (Stack safety) 19ms
 ✓ |core| src/stress/mvu.test.ts > Stress: MVU Correctness & Race Resistance > detects impurity in update function (using immutable checks in devMode) 1ms
 ✓ |core| src/stress/mvu_stress.test.ts > MVU Core Stress > processes 1,000,000 messages and measures throughput 208ms
 ✓ |core| src/stress/mvu_stress.test.ts > MVU Core Stress > handles rapid concurrent bursts and preserves FIFO 2ms
 ✓ |core| src/stress/mvu_stress.test.ts > MVU Core Stress > re-entrancy: verified that dispatch during update results in FIFO queuing 0ms
 ✓ |core| src/stress/mvu_stress.test.ts > MVU Core Stress > purity: deepFreeze catches mutations in devMode 0ms
 ✓ |core| src/stress/replay.test.ts > Stress: Deterministic Replay > Torture Test: Replays complex async session identically 233ms
 ✓ |core| src/stress/replay.test.ts > Stress: Deterministic Replay > Replay handles 10k log entries (Performance) 63ms
 ✓ |@causaloop/app-web| integration.test.ts > Causaloop Integration > Search: should ignore stale responses 1ms
 ✓ |@causaloop/app-web| integration.test.ts > Causaloop Integration > Cancellation: should handle load and cancel 0ms
 ✓ |@causaloop/app-web| integration.test.ts > Causaloop Integration > Replay: should yield identical final model 0ms
 ✓ |platform-browser| src/stress/effects.test.ts > Stress: Effects as Data Integrity > Fetch: handles 500 errors gracefully 58ms
 ✓ |platform-browser| src/stress/effects.test.ts > Stress: Effects as Data Integrity > Fetch: handles abortKey overwrite (Leak detection) 1ms
 ✓ |platform-browser| src/stress/effects.test.ts > Stress: Effects as Data Integrity > Worker: handles rapid creation/spam 6ms
 ✓ |platform-browser| src/stress/effects.test.ts > Stress: Effects as Data Integrity > Worker: correctly handles crashes 0ms
 ✓ |platform-browser| src/stress/effects.test.ts > Stress: Effects as Data Integrity > Worker Pool: reuses idle workers 0ms
 ✓ |platform-browser| src/stress/effects.test.ts > Stress: Effects as Data Integrity > Worker Pool: queues tasks when pool is full 0ms
 ✓ |platform-browser| src/stress/effects_stress.test.ts > Effects Extreme Stress > Timer Storm: handles 1,000 concurrent timers 105ms
 ✓ |platform-browser| src/stress/effects_stress.test.ts > Effects Extreme Stress > Fetch/Cancel Race: rapidly schedules and cancels requests 3ms
 ✓ |platform-browser| src/stress/effects_stress.test.ts > Effects Extreme Stress > RAF: processes backlog of animation frames 2ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  |platform-browser| src/stress/vdom_stress.test.ts [ packages/platform-browser/src/stress/vdom_stress.test.ts ]
Error: Failed to resolve entry for package "@causaloop/core". The package may have incorrect main/module/exports specified in its package.json.
  Plugin: vite:import-analysis
  File: /Users/name/trusted-git/public-repos/battle-tester/causaloop-repo/packages/platform-browser/src/stress/vdom_stress.test.ts:3:25
  1  |  import { describe, it, expect, beforeEach } from "vitest";
  2  |  import { createSnabbdomRenderer } from "../renderer.js";
  3  |  import { h } from "@causaloop/core";
     |                     ^
  4  |  describe("VDOM Extreme Stress", () => {
  5  |    let root;
 ❯ packageEntryFailure ../../node_modules/.pnpm/vite@6.4.1_@types+node@25.2.3/node_modules/vite/dist/node/chunks/dep-D4NMHUTW.js:16198:15
 ❯ resolvePackageEntry ../../node_modules/.pnpm/vite@6.4.1_@types+node@25.2.3/node_modules/vite/dist/node/chunks/dep-D4NMHUTW.js:16195:3
 ❯ tryNodeResolve ../../node_modules/.pnpm/vite@6.4.1_@types+node@25.2.3/node_modules/vite/dist/node/chunks/dep-D4NMHUTW.js:16060:18
 ❯ ResolveIdContext.resolveId ../../node_modules/.pnpm/vite@6.4.1_@types+node@25.2.3/node_modules/vite/dist/node/chunks/dep-D4NMHUTW.js:15831:19
 ❯ EnvironmentPluginContainer.resolveId ../../node_modules/.pnpm/vite@6.4.1_@types+node@25.2.3/node_modules/vite/dist/node/chunks/dep-D4NMHUTW.js:42242:17
 ❯ TransformPluginContext.resolve ../../node_modules/.pnpm/vite@6.4.1_@types+node@25.2.3/node_modules/vite/dist/node/chunks/dep-D4NMHUTW.js:42449:15
 ❯ normalizeUrl ../../node_modules/.pnpm/vite@6.4.1_@types+node@25.2.3/node_modules/vite/dist/node/chunks/dep-D4NMHUTW.js:40492:26
 ❯ ../../node_modules/.pnpm/vite@6.4.1_@types+node@25.2.3/node_modules/vite/dist/node/chunks/dep-D4NMHUTW.js:40623:37

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯


 Test Files  1 failed | 8 passed (9)
      Tests  29 passed (29)
   Start at  22:39:17
   Duration  754ms (transform 184ms, setup 0ms, collect 330ms, tests 801ms, environment 1.39s, prepare 713ms)

